<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Chapter 11: Density Estimation with GMMs | Quanskill</title>
		<link
			href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&family=Source+Serif+4:ital,wght@0,400;0,600;1,400&display=swap"
			rel="stylesheet" />
		<link
			rel="stylesheet"
			href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css" />
		<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/contrib/auto-render.min.js"></script>
		<style>
			:root {
				--quanskill-blue: #0b2fa0;
				--quanskill-blue-dark: #081f6b;
				--quanskill-blue-light: #1a4fd0;
				--quanskill-orange: #ff9000;
				--quanskill-orange-dark: #e68200;
				--quanskill-orange-light: #ffab33;
				--text-primary: #1a1a2e;
				--text-secondary: #4a4a6a;
				--bg-primary: #fafbff;
				--bg-secondary: #ffffff;
				--bg-card: #ffffff;
				--border-color: #e8eaf6;
				--code-bg: #f5f7ff;
				--success: #10b981;
				--error: #ef4444;
				--ml-accent: #7c3aed;
				--gradient-blue: linear-gradient(135deg, #0b2fa0 0%, #1a4fd0 100%);
				--gradient-orange: linear-gradient(135deg, #ff9000 0%, #ffab33 100%);
			}

			* {
				margin: 0;
				padding: 0;
				box-sizing: border-box;
			}

			body {
				font-family: "Source Serif 4", Georgia, serif;
				background: var(--bg-primary);
				color: var(--text-primary);
				line-height: 1.8;
				font-size: 17px;
			}

			.header {
				background: var(--gradient-blue);
				color: white;
				padding: 1rem 2rem;
				position: fixed;
				top: 0;
				left: 0;
				right: 0;
				z-index: 1000;
				box-shadow: 0 4px 20px rgba(11, 47, 160, 0.3);
			}

			.header-content {
				max-width: 1400px;
				margin: 0 auto;
				display: flex;
				justify-content: space-between;
				align-items: center;
			}

			.header-logo {
				font-family: "Space Grotesk", sans-serif;
				font-weight: 700;
				font-size: 1.5rem;
				display: flex;
				align-items: center;
				gap: 0.5rem;
			}

			.header-logo-icon {
				width: 32px;
				height: 32px;
				background: var(--quanskill-orange);
				border-radius: 6px;
				display: flex;
				align-items: center;
				justify-content: center;
				font-weight: 700;
			}

			.sidebar {
				position: fixed;
				left: 0;
				top: 60px;
				bottom: 0;
				width: 300px;
				background: var(--bg-secondary);
				border-right: 1px solid var(--border-color);
				overflow-y: auto;
				padding: 1.5rem 0;
				z-index: 900;
				transition: transform 0.3s ease;
			}

			.sidebar-header {
				padding: 0 1.5rem 1rem;
				border-bottom: 1px solid var(--border-color);
				margin-bottom: 1rem;
			}

			.logo {
				display: flex;
				align-items: center;
				gap: 0.5rem;
				margin-bottom: 0.5rem;
			}

			.logo-icon {
				width: 32px;
				height: 32px;
				background: var(--quanskill-orange);
				border-radius: 6px;
				display: flex;
				align-items: center;
				justify-content: center;
				font-weight: 700;
				font-size: 1rem;
				color: white;
			}

			.logo-text {
				font-family: "Space Grotesk", sans-serif;
				font-size: 1.25rem;
				font-weight: 700;
				color: var(--quanskill-blue);
			}

			.chapter-title {
				font-family: "Space Grotesk", sans-serif;
				font-size: 0.75rem;
				text-transform: uppercase;
				letter-spacing: 0.1em;
				color: var(--text-secondary);
			}

			.nav-section {
				padding: 0.5rem 1.5rem;
			}

			.nav-section-title {
				font-family: "Space Grotesk", sans-serif;
				font-size: 0.7rem;
				text-transform: uppercase;
				letter-spacing: 0.1em;
				color: var(--text-secondary);
				padding: 0.5rem 1rem;
				font-weight: 600;
			}

			.nav-link {
				display: block;
				padding: 0.6rem 1rem;
				color: var(--text-secondary);
				text-decoration: none;
				font-family: "Space Grotesk", sans-serif;
				font-size: 0.9rem;
				border-radius: 8px;
				margin-bottom: 0.25rem;
				transition: all 0.2s ease;
				border-left: 3px solid transparent;
			}

			.nav-link:hover {
				background: var(--code-bg);
				color: var(--quanskill-blue);
			}

			.nav-link.active {
				background: rgba(11, 47, 160, 0.1);
				color: var(--quanskill-blue);
				border-left-color: var(--quanskill-orange);
				font-weight: 500;
			}

			.main-content {
				margin-left: 300px;
				padding: 80px 2rem 4rem;
				max-width: calc(100% - 300px);
			}

			.content-wrapper {
				max-width: 850px;
				margin: 0 auto;
			}

			.hero {
				background: var(--gradient-blue);
				color: white;
				padding: 4rem 3rem;
				border-radius: 20px;
				margin-bottom: 3rem;
				position: relative;
				overflow: hidden;
			}

			.hero::before {
				content: "";
				position: absolute;
				top: -50%;
				right: -20%;
				width: 400px;
				height: 400px;
				background: var(--quanskill-orange);
				border-radius: 50%;
				opacity: 0.1;
			}

			.hero-content {
				position: relative;
				z-index: 1;
			}

			.hero-badge {
				display: inline-block;
				background: var(--quanskill-orange);
				color: white;
				padding: 0.35rem 1rem;
				border-radius: 20px;
				font-family: "Space Grotesk", sans-serif;
				font-size: 0.8rem;
				font-weight: 600;
				margin-bottom: 1rem;
			}

			.hero h1 {
				font-family: "Space Grotesk", sans-serif;
				font-size: 2.5rem;
				font-weight: 700;
				margin-bottom: 1rem;
				line-height: 1.2;
			}

			.hero-subtitle {
				font-size: 1.15rem;
				opacity: 0.9;
				max-width: 600px;
				line-height: 1.7;
			}

			.hero-quote {
				margin-top: 2rem;
				padding: 1.5rem;
				background: rgba(255, 255, 255, 0.1);
				border-left: 4px solid var(--quanskill-orange);
				border-radius: 0 12px 12px 0;
				font-style: italic;
			}

			.key-concepts {
				display: grid;
				grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
				gap: 1rem;
				margin: 2rem 0;
			}

			.concept-card {
				background: var(--bg-card);
				border: 1px solid var(--border-color);
				padding: 1.25rem;
				border-radius: 12px;
				transition: transform 0.2s, box-shadow 0.2s;
			}

			.concept-card:hover {
				transform: translateY(-4px);
				box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
			}

			.concept-card .icon {
				width: 40px;
				height: 40px;
				background: var(--gradient-orange);
				border-radius: 10px;
				display: flex;
				align-items: center;
				justify-content: center;
				margin-bottom: 0.75rem;
				font-size: 1.25rem;
			}

			.concept-card h5 {
				font-family: "Space Grotesk", sans-serif;
				font-size: 1rem;
				font-weight: 600;
				color: var(--text-primary);
				margin-bottom: 0.5rem;
			}

			.concept-card p {
				font-size: 0.9rem;
				color: var(--text-secondary);
				line-height: 1.5;
				margin-bottom: 0;
			}

			.section {
				background: var(--bg-card);
				border-radius: 16px;
				padding: 2.5rem;
				margin-bottom: 2rem;
				border: 1px solid var(--border-color);
				box-shadow: 0 4px 20px rgba(0, 0, 0, 0.03);
			}

			.section-header {
				display: flex;
				align-items: flex-start;
				gap: 1rem;
				margin-bottom: 2rem;
				padding-bottom: 1.5rem;
				border-bottom: 2px solid var(--border-color);
			}

			.section-number {
				font-family: "Space Grotesk", sans-serif;
				font-size: 0.9rem;
				font-weight: 700;
				color: white;
				background: var(--gradient-orange);
				padding: 0.5rem 1rem;
				border-radius: 8px;
				white-space: nowrap;
			}

			.section-header h2 {
				font-family: "Space Grotesk", sans-serif;
				font-size: 1.75rem;
				font-weight: 600;
				color: var(--quanskill-blue);
				line-height: 1.3;
			}

			.section h3 {
				font-family: "Space Grotesk", sans-serif;
				font-size: 1.35rem;
				font-weight: 600;
				color: var(--text-primary);
				margin: 2rem 0 1rem;
			}

			.section h4 {
				font-family: "Space Grotesk", sans-serif;
				font-size: 1.1rem;
				font-weight: 600;
				color: var(--text-primary);
				margin: 1.5rem 0 0.75rem;
			}

			.section p {
				margin-bottom: 1.25rem;
			}

			.definition-box {
				background: linear-gradient(
					135deg,
					rgba(11, 47, 160, 0.05) 0%,
					rgba(11, 47, 160, 0.02) 100%
				);
				border-left: 4px solid var(--quanskill-blue);
				padding: 1.5rem;
				border-radius: 0 12px 12px 0;
				margin: 1.5rem 0;
			}

			.definition-box .label {
				font-family: "Space Grotesk", sans-serif;
				font-size: 0.8rem;
				font-weight: 700;
				text-transform: uppercase;
				letter-spacing: 0.05em;
				color: var(--quanskill-blue);
				margin-bottom: 0.75rem;
				display: block;
			}

			.ml-box {
				background: linear-gradient(
					135deg,
					rgba(124, 58, 237, 0.08) 0%,
					rgba(124, 58, 237, 0.03) 100%
				);
				border-left: 4px solid var(--ml-accent);
				padding: 1.5rem;
				border-radius: 0 12px 12px 0;
				margin: 1.5rem 0;
			}

			.ml-box .label {
				font-family: "Space Grotesk", sans-serif;
				font-size: 0.8rem;
				font-weight: 700;
				text-transform: uppercase;
				letter-spacing: 0.05em;
				color: var(--ml-accent);
				margin-bottom: 0.75rem;
				display: flex;
				align-items: center;
				gap: 0.5rem;
			}

			.ml-box .label::before {
				content: "ü§ì";
			}

			.quanskill-box {
				background: linear-gradient(
					135deg,
					rgba(11, 47, 160, 0.1) 0%,
					rgba(255, 144, 0, 0.1) 100%
				);
				border: 2px solid var(--quanskill-blue);
				padding: 1.5rem;
				border-radius: 12px;
				margin: 1.5rem 0;
				position: relative;
			}

			.quanskill-box::before {
				content: "";
				position: absolute;
				top: 0;
				left: 0;
				right: 0;
				height: 4px;
				background: var(--gradient-orange);
				border-radius: 12px 12px 0 0;
			}

			.quanskill-box .label {
				font-family: "Space Grotesk", sans-serif;
				font-size: 0.8rem;
				font-weight: 700;
				text-transform: uppercase;
				letter-spacing: 0.05em;
				color: var(--quanskill-blue);
				margin-bottom: 0.75rem;
				display: flex;
				align-items: center;
				gap: 0.5rem;
			}

			.quanskill-box .label::before {
				content: "üéì";
			}

			.example-box {
				background: var(--code-bg);
				border: 1px solid var(--border-color);
				padding: 1.5rem;
				border-radius: 12px;
				margin: 1.5rem 0;
			}

			.example-box .label {
				font-family: "Space Grotesk", sans-serif;
				font-size: 0.8rem;
				font-weight: 700;
				text-transform: uppercase;
				letter-spacing: 0.05em;
				color: var(--quanskill-blue);
				margin-bottom: 0.75rem;
				display: flex;
				align-items: center;
				gap: 0.5rem;
			}

			.example-box .label::before {
				content: "√¢‚Äì¬∏";
				color: var(--quanskill-orange);
			}

			.note-box {
				background: linear-gradient(
					135deg,
					rgba(255, 144, 0, 0.08) 0%,
					rgba(255, 144, 0, 0.03) 100%
				);
				border-left: 4px solid var(--quanskill-orange);
				padding: 1.5rem;
				border-radius: 0 12px 12px 0;
				margin: 1.5rem 0;
			}

			.note-box .label {
				font-family: "Space Grotesk", sans-serif;
				font-size: 0.8rem;
				font-weight: 700;
				text-transform: uppercase;
				letter-spacing: 0.05em;
				color: var(--quanskill-orange-dark);
				margin-bottom: 0.75rem;
				display: block;
			}

			.realworld-box {
				background: linear-gradient(
					135deg,
					rgba(16, 185, 129, 0.08) 0%,
					rgba(16, 185, 129, 0.03) 100%
				);
				border-left: 4px solid var(--success);
				padding: 1.5rem;
				border-radius: 0 12px 12px 0;
				margin: 1.5rem 0;
			}

			.realworld-box .label {
				font-family: "Space Grotesk", sans-serif;
				font-size: 0.8rem;
				font-weight: 700;
				text-transform: uppercase;
				letter-spacing: 0.05em;
				color: var(--success);
				margin-bottom: 0.75rem;
				display: flex;
				align-items: center;
				gap: 0.5rem;
			}

			.realworld-box .label::before {
				content: "üéÅ";
			}

			code {
				font-family: "JetBrains Mono", monospace;
				background: var(--code-bg);
				padding: 0.2rem 0.4rem;
				border-radius: 4px;
				font-size: 0.9em;
				color: var(--quanskill-blue);
			}

			.math-display {
				overflow-x: auto;
				padding: 1rem;
				margin: 1rem 0;
				background: var(--code-bg);
				border-radius: 8px;
			}

			.katex-display {
				margin: 1rem 0 !important;
				overflow-x: auto;
				overflow-y: hidden;
			}

			.data-table,
			.comparison-table {
				width: 100%;
				border-collapse: collapse;
				margin: 1.5rem 0;
				font-size: 0.95rem;
			}

			.data-table th,
			.comparison-table th {
				background: var(--code-bg);
				font-family: "Space Grotesk", sans-serif;
				font-weight: 600;
				color: var(--quanskill-blue);
				padding: 0.75rem 1rem;
				text-align: left;
				border-bottom: 2px solid var(--border-color);
			}

			.data-table td,
			.comparison-table td {
				padding: 0.75rem 1rem;
				border-bottom: 1px solid var(--border-color);
			}

			.data-table tr:hover td,
			.comparison-table tr:hover td {
				background: rgba(11, 47, 160, 0.02);
			}

			.quiz-box {
				background: linear-gradient(135deg, #fef3c7 0%, #fef9e7 100%);
				border: 2px dashed var(--quanskill-orange);
				padding: 1.5rem;
				border-radius: 12px;
				margin: 2rem 0;
			}

			.quiz-box .label {
				font-family: "Space Grotesk", sans-serif;
				font-size: 0.9rem;
				font-weight: 700;
				color: var(--quanskill-orange-dark);
				margin-bottom: 1rem;
				display: flex;
				align-items: center;
				gap: 0.5rem;
			}

			.quiz-box .label::before {
				content: "üß†";
			}

			.quiz-question {
				font-weight: 600;
				margin-bottom: 1rem;
				color: var(--text-primary);
			}

			.quiz-options {
				display: flex;
				flex-direction: column;
				gap: 0.5rem;
			}

			.quiz-option {
				padding: 0.75rem 1rem;
				background: white;
				border: 2px solid var(--border-color);
				border-radius: 8px;
				cursor: pointer;
				transition: all 0.2s;
				font-family: "Space Grotesk", sans-serif;
			}

			.quiz-option:hover {
				border-color: var(--quanskill-blue);
				background: rgba(11, 47, 160, 0.05);
			}
			.quiz-option.correct {
				border-color: var(--success);
				background: rgba(16, 185, 129, 0.1);
			}
			.quiz-option.incorrect {
				border-color: var(--error);
				background: rgba(239, 68, 68, 0.1);
			}

			.quiz-feedback {
				margin-top: 1rem;
				padding: 1rem;
				border-radius: 8px;
				font-family: "Space Grotesk", sans-serif;
				display: none;
			}

			.quiz-feedback.show {
				display: block;
			}
			.quiz-feedback.correct {
				background: rgba(16, 185, 129, 0.1);
				color: var(--success);
			}
			.quiz-feedback.incorrect {
				background: rgba(239, 68, 68, 0.1);
				color: var(--error);
			}

			.demo-container {
				background: var(--bg-card);
				border: 2px solid var(--quanskill-blue);
				border-radius: 16px;
				padding: 2rem;
				margin: 2rem 0;
			}

			.demo-header {
				display: flex;
				align-items: center;
				gap: 0.5rem;
				margin-bottom: 1.5rem;
			}

			.demo-header h4 {
				font-family: "Space Grotesk", sans-serif;
				color: var(--quanskill-blue);
				font-size: 1.1rem;
			}

			.demo-header::before {
				content: "√¢≈°¬°";
			}

			.demo-controls {
				display: flex;
				flex-wrap: wrap;
				gap: 1.5rem;
				margin-bottom: 1.5rem;
				padding: 1rem;
				background: var(--code-bg);
				border-radius: 10px;
			}

			.control-group {
				display: flex;
				flex-direction: column;
				gap: 0.25rem;
			}

			.control-group label {
				font-family: "Space Grotesk", sans-serif;
				font-size: 0.85rem;
				color: var(--text-secondary);
			}

			.control-group input[type="range"] {
				width: 150px;
				height: 8px;
				border-radius: 4px;
				background: var(--border-color);
				outline: none;
				-webkit-appearance: none;
			}

			.control-group input[type="range"]::-webkit-slider-thumb {
				-webkit-appearance: none;
				width: 20px;
				height: 20px;
				border-radius: 50%;
				background: var(--quanskill-blue);
				cursor: pointer;
			}

			.control-group button {
				padding: 0.5rem 1rem;
				background: var(--quanskill-blue);
				color: white;
				border: none;
				border-radius: 8px;
				font-family: "Space Grotesk", sans-serif;
				cursor: pointer;
				transition: background 0.2s;
			}

			.control-group button:hover {
				background: var(--quanskill-blue-dark);
			}

			.demo-canvas {
				width: 100%;
				height: 350px;
				border: 1px solid var(--border-color);
				border-radius: 10px;
				background: white;
			}

			.demo-results {
				display: grid;
				grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
				gap: 1rem;
				margin-top: 1.5rem;
			}

			.result-item {
				background: var(--code-bg);
				padding: 1rem;
				border-radius: 10px;
				text-align: center;
			}

			.result-item .value {
				font-family: "JetBrains Mono", monospace;
				font-size: 1.5rem;
				font-weight: 700;
				color: var(--quanskill-blue);
			}

			.result-item .label {
				font-family: "Space Grotesk", sans-serif;
				font-size: 0.8rem;
				color: var(--text-secondary);
				margin-top: 0.25rem;
				text-transform: none;
				letter-spacing: normal;
			}

			.result-item .label::before {
				content: none;
			}

			.algorithm-box {
				background: #1e293b;
				color: white;
				padding: 1.5rem;
				border-radius: 12px;
				margin: 1.5rem 0;
			}

			.algorithm-box h4 {
				font-family: "Space Grotesk", sans-serif;
				color: var(--quanskill-orange);
				margin-bottom: 1rem;
				font-size: 1rem;
			}

			.algorithm-box ol {
				margin-left: 1.5rem;
			}

			.algorithm-box li {
				margin-bottom: 0.75rem;
				font-family: "JetBrains Mono", monospace;
				font-size: 0.9rem;
			}

			.mobile-menu-btn {
				display: none;
				position: fixed;
				top: 15px;
				left: 15px;
				z-index: 1001;
				background: var(--quanskill-blue);
				color: white;
				border: none;
				padding: 10px 15px;
				border-radius: 8px;
				cursor: pointer;
				font-size: 1.25rem;
			}

			@media (max-width: 1024px) {
				.sidebar {
					transform: translateX(-100%);
				}
				.sidebar.open {
					transform: translateX(0);
				}
				.main-content {
					margin-left: 0;
					max-width: 100%;
					padding: 80px 1.5rem 3rem;
				}
				.mobile-menu-btn {
					display: block;
				}
				.hero h1 {
					font-size: 2rem;
				}
				.section {
					padding: 1.5rem;
				}
				.progress-bar {
					left: 0;
				}
			}

			.progress-bar {
				position: fixed;
				top: 60px;
				left: 300px;
				right: 0;
				height: 3px;
				background: var(--border-color);
				z-index: 800;
			}

			.progress-fill {
				height: 100%;
				background: var(--gradient-orange);
				width: 0%;
				transition: width 0.1s;
			}

			ul,
			ol {
				margin: 1rem 0 1.5rem 1.5rem;
			}
			li {
				margin-bottom: 0.5rem;
			}
			li::marker {
				color: var(--quanskill-orange);
			}

			/* Floating Back to Main Button */
			.floating-back-btn {
				position: fixed;
				top: 75px;
				left: 15px;
				background: linear-gradient(135deg, #0b2fa0 0%, #1a4fd0 100%);
				color: white !important;
				padding: 0.6rem 1.2rem;
				border-radius: 25px;
				text-decoration: none !important;
				font-family: "Space Grotesk", sans-serif;
				font-weight: 600;
				font-size: 0.85rem;
				z-index: 9999;
				box-shadow: 0 4px 15px rgba(11, 47, 160, 0.3);
				transition: all 0.3s ease;
				display: flex;
				align-items: center;
				gap: 0.5rem;
			}
			.floating-back-btn:hover {
				transform: translateY(-2px);
				box-shadow: 0 6px 20px rgba(11, 47, 160, 0.4);
				background: linear-gradient(135deg, #ff9000 0%, #e68200 100%);
			}
			@media (max-width: 900px) {
				.floating-back-btn {
					top: auto;
					bottom: 20px;
					left: 15px;
					right: auto;
					padding: 0.5rem 1rem;
					font-size: 0.8rem;
				}
			}
		</style>
	</head>
	<body>
		<!-- Floating Back to Main Page Button -->
		<a href="index.html" class="floating-back-btn">‚Üê Main Page</a>

		<header class="header">
			<div class="header-content">
				<button class="mobile-menu-btn" onclick="toggleSidebar()">‚ò∞</button>
			</div>
		</header>

		<div class="progress-bar">
			<div class="progress-fill" id="progressFill"></div>
		</div>

		<nav class="sidebar" id="sidebar">
			<div class="sidebar-header">
				<div class="logo">
					<div class="logo-icon">Q</div>
					<span class="logo-text">Quanskill</span>
				</div>
				<div class="chapter-title">Chapter 11 ¬∑ Density Estimation</div>
			</div>

			<div class="nav-section">
				<div class="nav-section-title">Overview</div>
				<a href="#intro" class="nav-link active">Introduction</a>
			</div>

			<div class="nav-section">
				<div class="nav-section-title">Core Concepts</div>
				<a href="#section-11-1" class="nav-link">Gaussian Mixture Model</a>
				<a href="#section-11-2" class="nav-link">Maximum Likelihood</a>
				<a href="#section-11-3" class="nav-link">EM Algorithm</a>
				<a href="#section-11-4" class="nav-link">Latent Variable View</a>
			</div>

			<div class="nav-section">
				<div class="nav-section-title">Wrap Up</div>
				<a href="#summary" class="nav-link">Chapter Summary</a>
			</div>
		</nav>

		<main class="main-content">
			<div class="content-wrapper">
				<!-- Hero Section -->
				<section class="hero" id="intro">
					<div class="hero-content">
						<span class="hero-badge">Chapter 11</span>
						<h1>Density Estimation with Gaussian Mixture Models</h1>
						<p class="hero-subtitle">
							Learn to model complex, multimodal data distributions by combining
							simple Gaussian components. Master the EM algorithm for iterative
							parameter optimization.
						</p>
						<div class="hero-quote">
							"A mixture model says: your data isn't one thing ‚Äî it's a blend of
							several underlying patterns, each waiting to be discovered."
						</div>
					</div>
				</section>

				<!-- Key Concepts -->
				<div class="key-concepts">
					<div class="concept-card">
						<div class="icon">üìä</div>
						<h5>Mixture Models</h5>
						<p>Combine simple distributions for complex patterns</p>
					</div>
					<div class="concept-card">
						<div class="icon">üéØ</div>
						<h5>GMM Components</h5>
						<p>Each Gaussian captures a cluster in data</p>
					</div>
					<div class="concept-card">
						<div class="icon">üîîÔøΩÔøΩ</div>
						<h5>EM Algorithm</h5>
						<p>Iteratively optimize parameters</p>
					</div>
					<div class="concept-card">
						<div class="icon">üìà</div>
						<h5>Responsibilities</h5>
						<p>Soft cluster assignments</p>
					</div>
					<div class="concept-card">
						<div class="icon">üîÆ</div>
						<h5>Latent Variables</h5>
						<p>Hidden cluster memberships</p>
					</div>
					<div class="concept-card">
						<div class="icon">√¢≈°‚Äì√Ø¬∏¬è</div>
						<h5>Mixture Weights</h5>
						<p>Prior probability of each component</p>
					</div>
				</div>

				<!-- Section 11.1: Gaussian Mixture Model -->
				<section class="section" id="section-11-1">
					<div class="section-header">
						<span class="section-number">11.1</span>
						<h2>Gaussian Mixture Model</h2>
					</div>

					<p>
						A single Gaussian distribution cannot capture multimodal data ‚Äî data
						with multiple "clusters" or peaks.
						<strong>Mixture models</strong> solve this by combining multiple
						simple distributions.
					</p>

					<div class="definition-box">
						<span class="label">Definition: Gaussian Mixture Model</span>
						<p>A GMM is a convex combination of $K$ Gaussian distributions:</p>
						<div class="math-display">
							$$p(\mathbf{x} | \boldsymbol{\theta}) = \sum_{k=1}^{K} \pi_k
							\mathcal{N}(\mathbf{x} | \boldsymbol{\mu}_k,
							\boldsymbol{\Sigma}_k)$$
						</div>
						<p>where:</p>
						<ul>
							<li>
								$\pi_k$ are <strong>mixture weights</strong>: $0 \leq \pi_k \leq
								1$ and $\sum_k \pi_k = 1$
							</li>
							<li>$\boldsymbol{\mu}_k$ are component means</li>
							<li>$\boldsymbol{\Sigma}_k$ are component covariances</li>
						</ul>
					</div>

					<p>
						The parameters are $\boldsymbol{\theta} = \{\pi_k,
						\boldsymbol{\mu}_k, \boldsymbol{\Sigma}_k : k = 1, \ldots, K\}$. The
						mixture weights $\pi_k$ represent the prior probability that a data
						point belongs to component $k$.
					</p>

					<!-- Interactive GMM Demo -->
					<div class="demo-container">
						<div class="demo-header">
							<h4>Interactive: 1D Gaussian Mixture</h4>
						</div>
						<div class="demo-controls">
							<div class="control-group">
								<label>Component 1 Mean: <span id="mu1Val">-2</span></label>
								<input
									type="range"
									id="mu1Slider"
									min="-5"
									max="5"
									value="-2"
									step="0.5" />
							</div>
							<div class="control-group">
								<label>Component 2 Mean: <span id="mu2Val">2</span></label>
								<input
									type="range"
									id="mu2Slider"
									min="-5"
									max="5"
									value="2"
									step="0.5" />
							</div>
							<div class="control-group">
								<label>Weight œÄ√¢‚Äö¬Å: <span id="pi1Val">0.5</span></label>
								<input
									type="range"
									id="pi1Slider"
									min="0"
									max="100"
									value="50" />
							</div>
						</div>
						<canvas id="gmmCanvas" class="demo-canvas"></canvas>
						<div class="demo-results">
							<div class="result-item">
								<div class="value" id="gmmMean">‚Äî</div>
								<div class="label">Mixture Mean</div>
							</div>
							<div class="result-item">
								<div class="value" id="gmmVar">‚Äî</div>
								<div class="label">Mixture Variance</div>
							</div>
						</div>
					</div>

					<div class="example-box">
						<span class="label">Example: Why Mixtures?</span>
						<p>
							Consider heights in a mixed population of adults and children. A
							single Gaussian would average them poorly. But a 2-component GMM
							can model:
						</p>
						<ul>
							<li>Component 1: Children's heights (Œº √¢‚Ä∞ÀÜ 120cm)</li>
							<li>Component 2: Adults' heights (Œº √¢‚Ä∞ÀÜ 170cm)</li>
						</ul>
						<p>The mixture weights reflect the proportion of each group.</p>
					</div>

					<div class="ml-box">
						<span class="label">Why This Matters in ML</span>
						<p>GMMs are foundational for:</p>
						<ul>
							<li>
								<strong>Clustering:</strong> Soft assignments (probabilities vs.
								hard labels)
							</li>
							<li><strong>Density estimation:</strong> Generative modeling</li>
							<li>
								<strong>Anomaly detection:</strong> Low-probability regions
								indicate outliers
							</li>
							<li>
								<strong>Feature learning:</strong> GMM posteriors as features
							</li>
						</ul>
					</div>
				</section>

				<!-- Section 11.2: Maximum Likelihood -->
				<section class="section" id="section-11-2">
					<div class="section-header">
						<span class="section-number">11.2</span>
						<h2>Parameter Learning via Maximum Likelihood</h2>
					</div>

					<p>
						Given data $\mathcal{X} = \{\mathbf{x}_1, \ldots, \mathbf{x}_N\}$,
						we want to find GMM parameters that maximize the likelihood:
					</p>
					<div class="math-display">
						$$\mathcal{L}(\boldsymbol{\theta}) = \log p(\mathcal{X} |
						\boldsymbol{\theta}) = \sum_{n=1}^{N} \log \sum_{k=1}^{K} \pi_k
						\mathcal{N}(\mathbf{x}_n | \boldsymbol{\mu}_k,
						\boldsymbol{\Sigma}_k)$$
					</div>

					<div class="note-box">
						<span class="label">The Problem</span>
						<p>
							Unlike single-Gaussian MLE, the
							<strong>log doesn't simplify</strong> the sum over components. We
							can't get a closed-form solution! The parameters are coupled
							through the sum inside the log.
						</p>
					</div>

					<h3>Responsibilities</h3>
					<p>
						A key quantity emerges when we take derivatives: the
						<strong>responsibility</strong> of component $k$ for data point $n$:
					</p>
					<div class="math-display">
						$$r_{nk} = \frac{\pi_k \mathcal{N}(\mathbf{x}_n |
						\boldsymbol{\mu}_k, \boldsymbol{\Sigma}_k)}{\sum_{j=1}^{K} \pi_j
						\mathcal{N}(\mathbf{x}_n | \boldsymbol{\mu}_j,
						\boldsymbol{\Sigma}_j)}$$
					</div>

					<div class="definition-box">
						<span class="label">Interpretation: Responsibilities</span>
						<p>
							$r_{nk}$ is the <strong>posterior probability</strong> that data
							point $\mathbf{x}_n$ was generated by component $k$. It's a "soft
							assignment":
						</p>
						<ul>
							<li>$r_{nk} \in [0, 1]$ for all $n, k$</li>
							<li>$\sum_k r_{nk} = 1$ for each data point</li>
							<li>High $r_{nk}$ means component $k$ "claims" data point $n$</li>
						</ul>
					</div>

					<h3>Update Equations</h3>
					<p>
						Setting the gradient to zero and solving (with responsibilities
						fixed) gives:
					</p>

					<div class="math-display">
						$$\boldsymbol{\mu}_k^{\text{new}} = \frac{\sum_{n=1}^{N} r_{nk}
						\mathbf{x}_n}{\sum_{n=1}^{N} r_{nk}} = \frac{1}{N_k} \sum_{n=1}^{N}
						r_{nk} \mathbf{x}_n$$
					</div>

					<div class="math-display">
						$$\boldsymbol{\Sigma}_k^{\text{new}} = \frac{1}{N_k} \sum_{n=1}^{N}
						r_{nk} (\mathbf{x}_n - \boldsymbol{\mu}_k)(\mathbf{x}_n -
						\boldsymbol{\mu}_k)^\top$$
					</div>

					<div class="math-display">$$\pi_k^{\text{new}} = \frac{N_k}{N}$$</div>

					<p>
						where $N_k = \sum_{n=1}^{N} r_{nk}$ is the "effective" number of
						points assigned to component $k$.
					</p>

					<div class="quiz-box">
						<span class="label">Quick Check</span>
						<p class="quiz-question">
							If all data points have responsibility $r_{nk} = 1$ for component
							$k$ and $r_{nj} = 0$ for $j \neq k$, what does the mean update
							become?
						</p>
						<div class="quiz-options">
							<div class="quiz-option" onclick="checkQuiz(this, true)">
								The standard sample mean of all data points
							</div>
							<div class="quiz-option" onclick="checkQuiz(this, false)">
								Zero
							</div>
							<div class="quiz-option" onclick="checkQuiz(this, false)">
								The mean of other components
							</div>
							<div class="quiz-option" onclick="checkQuiz(this, false)">
								Undefined
							</div>
						</div>
						<div class="quiz-feedback correct">
							Correct! With $r_{nk} = 1$ for all $n$, the weighted mean becomes
							the simple arithmetic mean: $\boldsymbol{\mu}_k =
							\frac{1}{N}\sum_n \mathbf{x}_n$
						</div>
						<div class="quiz-feedback incorrect">
							Not quite. Think about what happens when every data point fully
							belongs to one component.
						</div>
					</div>
				</section>

				<!-- Section 11.3: EM Algorithm -->
				<section class="section" id="section-11-3">
					<div class="section-header">
						<span class="section-number">11.3</span>
						<h2>EM Algorithm</h2>
					</div>

					<p>
						The updates form a chicken-and-egg problem: responsibilities depend
						on parameters, and optimal parameters depend on responsibilities.
						The <strong>Expectation-Maximization (EM)</strong> algorithm breaks
						this cycle by iterating:
					</p>

					<div class="algorithm-box">
						<h4>Algorithm: EM for Gaussian Mixture Models</h4>
						<ol>
							<li>
								<strong>Initialize:</strong> Set initial values for
								$\boldsymbol{\mu}_k, \boldsymbol{\Sigma}_k, \pi_k$
							</li>
							<li>
								<strong>E-step:</strong> Compute responsibilities $r_{nk}$ using
								current parameters
							</li>
							<li>
								<strong>M-step:</strong> Update parameters using current
								responsibilities: <br />‚Ä¢ $\boldsymbol{\mu}_k \leftarrow
								\frac{1}{N_k}\sum_n r_{nk}\mathbf{x}_n$ <br />‚Ä¢
								$\boldsymbol{\Sigma}_k \leftarrow \frac{1}{N_k}\sum_n
								r_{nk}(\mathbf{x}_n - \boldsymbol{\mu}_k)(\mathbf{x}_n -
								\boldsymbol{\mu}_k)^\top$ <br />‚Ä¢ $\pi_k \leftarrow N_k / N$
							</li>
							<li>
								<strong>Evaluate:</strong> Compute log-likelihood
								$\mathcal{L}(\boldsymbol{\theta})$
							</li>
							<li><strong>Repeat:</strong> Steps 2-4 until convergence</li>
						</ol>
					</div>

					<!-- EM Interactive Demo -->
					<div class="demo-container">
						<div class="demo-header">
							<h4>Interactive: EM Algorithm in Action</h4>
						</div>
						<div class="demo-controls">
							<div class="control-group">
								<label>Components (K): <span id="kVal">3</span></label>
								<input type="range" id="kSlider" min="2" max="5" value="3" />
							</div>
							<div class="control-group">
								<button id="stepBtn">Run 1 EM Step</button>
							</div>
							<div class="control-group">
								<button id="resetBtn">Reset</button>
							</div>
						</div>
						<canvas id="emCanvas" class="demo-canvas"></canvas>
						<div class="demo-results">
							<div class="result-item">
								<div class="value" id="iteration">0</div>
								<div class="label">EM Iteration</div>
							</div>
							<div class="result-item">
								<div class="value" id="logLik">‚Äî</div>
								<div class="label">Log-Likelihood</div>
							</div>
							<div class="result-item">
								<div class="value" id="converged">No</div>
								<div class="label">Converged</div>
							</div>
						</div>
					</div>

					<h3>Key Properties of EM</h3>
					<ul>
						<li>
							<strong>Monotonic improvement:</strong> Log-likelihood never
							decreases
						</li>
						<li>
							<strong>Convergence:</strong> Guaranteed to reach a local optimum
						</li>
						<li>
							<strong>Initialization sensitive:</strong> Different starts ‚Üí
							different solutions
						</li>
						<li><strong>No learning rate:</strong> Unlike gradient descent</li>
					</ul>

					<div class="note-box">
						<span class="label">Practical Tips</span>
						<ul>
							<li>Run EM multiple times with different initializations</li>
							<li>Use k-means to initialize GMM parameters</li>
							<li>
								Add small regularization to covariances to avoid singularities
							</li>
							<li>Monitor log-likelihood for convergence</li>
						</ul>
					</div>

					<div class="quiz-box">
						<span class="label">Quick Check</span>
						<p class="quiz-question">What does the E-step compute?</p>
						<div class="quiz-options">
							<div class="quiz-option" onclick="checkQuiz(this, false)">
								New values for the means
							</div>
							<div class="quiz-option" onclick="checkQuiz(this, true)">
								Responsibilities (soft assignments)
							</div>
							<div class="quiz-option" onclick="checkQuiz(this, false)">
								The log-likelihood
							</div>
							<div class="quiz-option" onclick="checkQuiz(this, false)">
								New values for mixture weights
							</div>
						</div>
						<div class="quiz-feedback correct">
							Correct! E-step computes the expected cluster assignments
							(responsibilities) given current parameters. M-step then updates
							parameters using these responsibilities.
						</div>
						<div class="quiz-feedback incorrect">
							Not quite. Remember: E = Expectation (compute expected hidden
							variables), M = Maximization (update parameters).
						</div>
					</div>
				</section>

				<!-- Section 11.4: Latent Variable View -->
				<section class="section" id="section-11-4">
					<div class="section-header">
						<span class="section-number">11.4</span>
						<h2>Latent Variable Perspective</h2>
					</div>

					<p>
						GMMs have a beautiful interpretation using
						<strong>latent (hidden) variables</strong>. We introduce a discrete
						latent variable $z_n \in \{1, \ldots, K\}$ indicating which
						component generated $\mathbf{x}_n$.
					</p>

					<div class="definition-box">
						<span class="label">Generative Model</span>
						<p>The GMM can be viewed as a two-step generative process:</p>
						<ol>
							<li>
								Sample component assignment: $z_n \sim
								\text{Categorical}(\boldsymbol{\pi})$
							</li>
							<li>
								Sample data from that component: $\mathbf{x}_n | z_n = k \sim
								\mathcal{N}(\boldsymbol{\mu}_k, \boldsymbol{\Sigma}_k)$
							</li>
						</ol>
					</div>

					<p>The joint distribution is:</p>
					<div class="math-display">
						$$p(\mathbf{x}_n, z_n = k) = p(\mathbf{x}_n | z_n = k) p(z_n = k) =
						\mathcal{N}(\mathbf{x}_n | \boldsymbol{\mu}_k,
						\boldsymbol{\Sigma}_k) \cdot \pi_k$$
					</div>

					<p>Marginalizing out $z_n$ recovers the GMM density:</p>
					<div class="math-display">
						$$p(\mathbf{x}_n) = \sum_{k=1}^{K} p(\mathbf{x}_n, z_n = k) =
						\sum_{k=1}^{K} \pi_k \mathcal{N}(\mathbf{x}_n | \boldsymbol{\mu}_k,
						\boldsymbol{\Sigma}_k)$$
					</div>

					<h3>Responsibilities as Posteriors</h3>
					<p>
						Using Bayes' theorem, the responsibility is the
						<strong>posterior probability</strong> of the latent variable:
					</p>
					<div class="math-display">
						$$r_{nk} = p(z_n = k | \mathbf{x}_n) = \frac{p(\mathbf{x}_n | z_n =
						k) p(z_n = k)}{p(\mathbf{x}_n)}$$
					</div>

					<div class="ml-box">
						<span class="label">Why This Matters in ML</span>
						<p>The latent variable view connects GMMs to:</p>
						<ul>
							<li>
								<strong>Variational Autoencoders (VAEs):</strong> Continuous
								latent variables
							</li>
							<li>
								<strong>Hidden Markov Models:</strong> Sequential latent states
							</li>
							<li>
								<strong>Topic Models (LDA):</strong> Document-topic mixtures
							</li>
							<li>
								<strong>General EM:</strong> Framework for any latent variable
								model
							</li>
						</ul>
					</div>

					<div class="realworld-box">
						<span class="label">Real-World Applications</span>
						<ul>
							<li>
								<strong>Image segmentation:</strong> Pixel clustering for object
								detection
							</li>
							<li>
								<strong>Speaker diarization:</strong> "Who spoke when" in audio
							</li>
							<li>
								<strong>Customer segmentation:</strong> Market analysis and
								targeting
							</li>
							<li>
								<strong>Anomaly detection:</strong> Low-density regions indicate
								outliers
							</li>
							<li>
								<strong>Data augmentation:</strong> Sample new data from the
								model
							</li>
						</ul>
					</div>
				</section>

				<!-- Summary Section -->
				<section class="section" id="summary">
					<div class="section-header">
						<span class="section-number">Summary</span>
						<h2>Chapter Summary</h2>
					</div>

					<h3>Key Equations</h3>
					<table class="data-table">
						<thead>
							<tr>
								<th>Concept</th>
								<th>Formula</th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td>GMM Density</td>
								<td>
									$p(\mathbf{x}) = \sum_{k=1}^{K} \pi_k \mathcal{N}(\mathbf{x} |
									\boldsymbol{\mu}_k, \boldsymbol{\Sigma}_k)$
								</td>
							</tr>
							<tr>
								<td>Responsibility</td>
								<td>
									$r_{nk} = \frac{\pi_k \mathcal{N}(\mathbf{x}_n |
									\boldsymbol{\mu}_k, \boldsymbol{\Sigma}_k)}{\sum_j \pi_j
									\mathcal{N}(\mathbf{x}_n | \boldsymbol{\mu}_j,
									\boldsymbol{\Sigma}_j)}$
								</td>
							</tr>
							<tr>
								<td>Mean Update</td>
								<td>
									$\boldsymbol{\mu}_k = \frac{1}{N_k}\sum_n r_{nk}\mathbf{x}_n$
								</td>
							</tr>
							<tr>
								<td>Covariance Update</td>
								<td>
									$\boldsymbol{\Sigma}_k = \frac{1}{N_k}\sum_n
									r_{nk}(\mathbf{x}_n - \boldsymbol{\mu}_k)(\mathbf{x}_n -
									\boldsymbol{\mu}_k)^\top$
								</td>
							</tr>
							<tr>
								<td>Weight Update</td>
								<td>$\pi_k = N_k / N$</td>
							</tr>
						</tbody>
					</table>

					<h3>Core Concepts Recap</h3>
					<div class="key-concepts">
						<div class="concept-card">
							<div class="icon">1√Ø¬∏¬è√¢∆í¬£</div>
							<h5>Mixture Models</h5>
							<p>Convex combination of base distributions</p>
						</div>
						<div class="concept-card">
							<div class="icon">2√Ø¬∏¬è√¢∆í¬£</div>
							<h5>Responsibilities</h5>
							<p>Soft cluster assignments (posterior probabilities)</p>
						</div>
						<div class="concept-card">
							<div class="icon">3√Ø¬∏¬è√¢∆í¬£</div>
							<h5>EM Algorithm</h5>
							<p>E-step (responsibilities) + M-step (parameters)</p>
						</div>
						<div class="concept-card">
							<div class="icon">4√Ø¬∏¬è√¢∆í¬£</div>
							<h5>Latent Variables</h5>
							<p>Hidden cluster membership indicators</p>
						</div>
					</div>

					<div class="quanskill-box">
						<span class="label">Quanskill Learning Path</span>
						<p><strong>Next Steps:</strong></p>
						<ul>
							<li>üéØ <strong>Chapter 12:</strong> Classification with SVMs</li>
						</ul>
						<p><strong>Practice Projects:</strong></p>
						<ul>
							<li>Implement GMM and EM from scratch</li>
							<li>Compare GMM clustering vs. k-means</li>
							<li>Use GMM for anomaly detection on real data</li>
							<li>Visualize EM convergence with different initializations</li>
						</ul>
					</div>
				</section>
			</div>
		</main>

		<script>
			// Initialize KaTeX
			document.addEventListener("DOMContentLoaded", function () {
				renderMathInElement(document.body, {
					delimiters: [
						{ left: "$$", right: "$$", display: true },
						{ left: "\\[", right: "\\]", display: true },
						{ left: "$", right: "$", display: false },
						{ left: "\\(", right: "\\)", display: false },
					],
					throwOnError: false,
				});
			});

			function checkQuiz(element, isCorrect) {
				const quizBox = element.closest(".quiz-box");
				const options = quizBox.querySelectorAll(".quiz-option");
				const feedbacks = quizBox.querySelectorAll(".quiz-feedback");

				options.forEach((opt) => {
					opt.style.pointerEvents = "none";
					opt.classList.remove("correct", "incorrect");
				});

				if (isCorrect) {
					element.classList.add("correct");
					feedbacks[0].classList.add("show");
				} else {
					element.classList.add("incorrect");
					feedbacks[1].classList.add("show");
				}
			}

			function toggleSidebar() {
				document.getElementById("sidebar").classList.toggle("open");
			}

			window.addEventListener("scroll", () => {
				const winScroll = document.documentElement.scrollTop;
				const height =
					document.documentElement.scrollHeight -
					document.documentElement.clientHeight;
				const scrolled = (winScroll / height) * 100;
				document.getElementById("progressFill").style.width = scrolled + "%";
			});

			const sections = document.querySelectorAll(".section, .hero");
			const navLinks = document.querySelectorAll(".nav-link");

			window.addEventListener("scroll", () => {
				let current = "";
				sections.forEach((section) => {
					const sectionTop = section.offsetTop;
					if (scrollY >= sectionTop - 200) {
						current = section.getAttribute("id");
					}
				});

				navLinks.forEach((link) => {
					link.classList.remove("active");
					if (link.getAttribute("href") === "#" + current) {
						link.classList.add("active");
					}
				});
			});

			// ========== GMM Demo ==========
			const gmmCanvas = document.getElementById("gmmCanvas");
			const gmmCtx = gmmCanvas.getContext("2d");

			function gaussian(x, mu, sigma) {
				return (
					(1 / (sigma * Math.sqrt(2 * Math.PI))) *
					Math.exp(-0.5 * Math.pow((x - mu) / sigma, 2))
				);
			}

			function drawGMM() {
				const width = (gmmCanvas.width = gmmCanvas.offsetWidth);
				const height = (gmmCanvas.height = gmmCanvas.offsetHeight);

				gmmCtx.clearRect(0, 0, width, height);

				const mu1 = parseFloat(document.getElementById("mu1Slider").value);
				const mu2 = parseFloat(document.getElementById("mu2Slider").value);
				const pi1 = parseInt(document.getElementById("pi1Slider").value) / 100;
				const pi2 = 1 - pi1;
				const sigma = 1.0;

				document.getElementById("mu1Val").textContent = mu1.toFixed(1);
				document.getElementById("mu2Val").textContent = mu2.toFixed(1);
				document.getElementById("pi1Val").textContent = pi1.toFixed(2);

				const margin = 50;
				const plotWidth = width - 2 * margin;
				const plotHeight = height - 2 * margin;

				const xMin = -7,
					xMax = 7;
				const scaleX = (x) => margin + ((x - xMin) / (xMax - xMin)) * plotWidth;
				const scaleY = (y, maxY) => height - margin - (y / maxY) * plotHeight;

				// Find max Y for scaling
				let maxY = 0;
				for (let i = 0; i <= 200; i++) {
					const x = xMin + (i / 200) * (xMax - xMin);
					const y =
						pi1 * gaussian(x, mu1, sigma) + pi2 * gaussian(x, mu2, sigma);
					maxY = Math.max(maxY, y);
				}
				maxY *= 1.1;

				// Draw axes
				gmmCtx.strokeStyle = "#e8eaf6";
				gmmCtx.lineWidth = 1;
				gmmCtx.beginPath();
				gmmCtx.moveTo(margin, height - margin);
				gmmCtx.lineTo(width - margin, height - margin);
				gmmCtx.moveTo(margin, margin);
				gmmCtx.lineTo(margin, height - margin);
				gmmCtx.stroke();

				// Draw component 1 (weighted)
				gmmCtx.strokeStyle = "#ff9000";
				gmmCtx.lineWidth = 2;
				gmmCtx.setLineDash([5, 5]);
				gmmCtx.beginPath();
				for (let i = 0; i <= 200; i++) {
					const x = xMin + (i / 200) * (xMax - xMin);
					const y = pi1 * gaussian(x, mu1, sigma);
					if (i === 0) gmmCtx.moveTo(scaleX(x), scaleY(y, maxY));
					else gmmCtx.lineTo(scaleX(x), scaleY(y, maxY));
				}
				gmmCtx.stroke();

				// Draw component 2 (weighted)
				gmmCtx.strokeStyle = "#10b981";
				gmmCtx.beginPath();
				for (let i = 0; i <= 200; i++) {
					const x = xMin + (i / 200) * (xMax - xMin);
					const y = pi2 * gaussian(x, mu2, sigma);
					if (i === 0) gmmCtx.moveTo(scaleX(x), scaleY(y, maxY));
					else gmmCtx.lineTo(scaleX(x), scaleY(y, maxY));
				}
				gmmCtx.stroke();
				gmmCtx.setLineDash([]);

				// Draw mixture
				gmmCtx.strokeStyle = "#0b2fa0";
				gmmCtx.lineWidth = 3;
				gmmCtx.beginPath();
				for (let i = 0; i <= 200; i++) {
					const x = xMin + (i / 200) * (xMax - xMin);
					const y =
						pi1 * gaussian(x, mu1, sigma) + pi2 * gaussian(x, mu2, sigma);
					if (i === 0) gmmCtx.moveTo(scaleX(x), scaleY(y, maxY));
					else gmmCtx.lineTo(scaleX(x), scaleY(y, maxY));
				}
				gmmCtx.stroke();

				// Legend
				gmmCtx.font = "12px Space Grotesk, sans-serif";
				gmmCtx.fillStyle = "#ff9000";
				gmmCtx.fillText("œÄ√¢‚Äö¬Å¬∑N(Œº√¢‚Äö¬Å)", width - 100, 25);
				gmmCtx.fillStyle = "#10b981";
				gmmCtx.fillText("œÄ√¢‚Äö‚Äö¬∑N(Œº√¢‚Äö‚Äö)", width - 100, 45);
				gmmCtx.fillStyle = "#0b2fa0";
				gmmCtx.fillText("GMM", width - 100, 65);

				// Update stats
				const mixtureMean = pi1 * mu1 + pi2 * mu2;
				const mixtureVar =
					pi1 * (sigma * sigma + mu1 * mu1) +
					pi2 * (sigma * sigma + mu2 * mu2) -
					mixtureMean * mixtureMean;
				document.getElementById("gmmMean").textContent = mixtureMean.toFixed(2);
				document.getElementById("gmmVar").textContent = mixtureVar.toFixed(2);
			}

			// ========== EM Demo ==========
			const emCanvas = document.getElementById("emCanvas");
			const emCtx = emCanvas.getContext("2d");

			let emData = [];
			let emParams = [];
			let emIteration = 0;
			let prevLogLik = -Infinity;

			const colors = ["#0b2fa0", "#ff9000", "#10b981", "#7c3aed", "#ef4444"];

			function generateEMData() {
				emData = [];
				// Generate 3 clusters
				const clusters = [
					{ mu: [-3, 2], sigma: 0.8, n: 30 },
					{ mu: [2, 3], sigma: 0.6, n: 25 },
					{ mu: [0, -2], sigma: 0.7, n: 35 },
				];

				clusters.forEach((c) => {
					for (let i = 0; i < c.n; i++) {
						const x = c.mu[0] + (Math.random() - 0.5) * 2 * c.sigma * 2;
						const y = c.mu[1] + (Math.random() - 0.5) * 2 * c.sigma * 2;
						emData.push([x, y]);
					}
				});
			}

			function initEMParams() {
				const K = parseInt(document.getElementById("kSlider").value);
				emParams = [];

				for (let k = 0; k < K; k++) {
					emParams.push({
						mu: [(Math.random() - 0.5) * 8, (Math.random() - 0.5) * 8],
						sigma: 1.0,
						pi: 1.0 / K,
					});
				}

				emIteration = 0;
				prevLogLik = -Infinity;
			}

			function computeResponsibilities() {
				const N = emData.length;
				const K = emParams.length;
				const r = [];

				for (let n = 0; n < N; n++) {
					r[n] = [];
					let total = 0;

					for (let k = 0; k < K; k++) {
						const dx = emData[n][0] - emParams[k].mu[0];
						const dy = emData[n][1] - emParams[k].mu[1];
						const dist2 = dx * dx + dy * dy;
						const sigma2 = emParams[k].sigma * emParams[k].sigma;
						const lik =
							(emParams[k].pi * Math.exp(-dist2 / (2 * sigma2))) /
							(2 * Math.PI * sigma2);
						r[n][k] = lik;
						total += lik;
					}

					for (let k = 0; k < K; k++) {
						r[n][k] = total > 0 ? r[n][k] / total : 1.0 / K;
					}
				}

				return r;
			}

			function emStep() {
				const N = emData.length;
				const K = emParams.length;

				// E-step
				const r = computeResponsibilities();

				// M-step
				for (let k = 0; k < K; k++) {
					let Nk = 0;
					let muX = 0,
						muY = 0;

					for (let n = 0; n < N; n++) {
						Nk += r[n][k];
						muX += r[n][k] * emData[n][0];
						muY += r[n][k] * emData[n][1];
					}

					if (Nk > 0.001) {
						emParams[k].mu = [muX / Nk, muY / Nk];

						let sigmaSum = 0;
						for (let n = 0; n < N; n++) {
							const dx = emData[n][0] - emParams[k].mu[0];
							const dy = emData[n][1] - emParams[k].mu[1];
							sigmaSum += r[n][k] * (dx * dx + dy * dy);
						}
						emParams[k].sigma = Math.sqrt(sigmaSum / (2 * Nk)) + 0.1;
						emParams[k].pi = Nk / N;
					}
				}

				emIteration++;
				return r;
			}

			function computeLogLikelihood() {
				const N = emData.length;
				const K = emParams.length;
				let logLik = 0;

				for (let n = 0; n < N; n++) {
					let lik = 0;
					for (let k = 0; k < K; k++) {
						const dx = emData[n][0] - emParams[k].mu[0];
						const dy = emData[n][1] - emParams[k].mu[1];
						const dist2 = dx * dx + dy * dy;
						const sigma2 = emParams[k].sigma * emParams[k].sigma;
						lik +=
							(emParams[k].pi * Math.exp(-dist2 / (2 * sigma2))) /
							(2 * Math.PI * sigma2);
					}
					logLik += Math.log(lik + 1e-10);
				}

				return logLik;
			}

			function drawEM(responsibilities) {
				const width = (emCanvas.width = emCanvas.offsetWidth);
				const height = (emCanvas.height = emCanvas.offsetHeight);

				emCtx.clearRect(0, 0, width, height);

				const margin = 40;
				const plotSize = Math.min(width, height) - 2 * margin;
				const centerX = width / 2;
				const centerY = height / 2;
				const scale = plotSize / 12;

				const scaleX = (x) => centerX + x * scale;
				const scaleY = (y) => centerY - y * scale;

				// Draw axes
				emCtx.strokeStyle = "#e8eaf6";
				emCtx.lineWidth = 1;
				emCtx.beginPath();
				emCtx.moveTo(margin, centerY);
				emCtx.lineTo(width - margin, centerY);
				emCtx.moveTo(centerX, margin);
				emCtx.lineTo(centerX, height - margin);
				emCtx.stroke();

				const K = emParams.length;
				const r = responsibilities || computeResponsibilities();

				// Draw data points colored by responsibility
				emData.forEach((point, n) => {
					let maxK = 0;
					let maxR = r[n][0];
					for (let k = 1; k < K; k++) {
						if (r[n][k] > maxR) {
							maxR = r[n][k];
							maxK = k;
						}
					}

					emCtx.fillStyle = colors[maxK];
					emCtx.globalAlpha = 0.3 + 0.7 * maxR;
					emCtx.beginPath();
					emCtx.arc(scaleX(point[0]), scaleY(point[1]), 5, 0, Math.PI * 2);
					emCtx.fill();
				});

				emCtx.globalAlpha = 1;

				// Draw component centers
				emParams.forEach((param, k) => {
					// Draw ellipse for covariance
					emCtx.strokeStyle = colors[k];
					emCtx.lineWidth = 2;
					emCtx.beginPath();
					emCtx.ellipse(
						scaleX(param.mu[0]),
						scaleY(param.mu[1]),
						param.sigma * scale * 2,
						param.sigma * scale * 2,
						0,
						0,
						Math.PI * 2
					);
					emCtx.stroke();

					// Draw center
					emCtx.fillStyle = colors[k];
					emCtx.beginPath();
					emCtx.arc(
						scaleX(param.mu[0]),
						scaleY(param.mu[1]),
						8,
						0,
						Math.PI * 2
					);
					emCtx.fill();

					// Label
					emCtx.fillStyle = "white";
					emCtx.font = "bold 12px Space Grotesk";
					emCtx.textAlign = "center";
					emCtx.textBaseline = "middle";
					emCtx.fillText(k + 1, scaleX(param.mu[0]), scaleY(param.mu[1]));
				});

				// Update stats
				const logLik = computeLogLikelihood();
				document.getElementById("iteration").textContent = emIteration;
				document.getElementById("logLik").textContent = logLik.toFixed(1);

				const converged =
					Math.abs(logLik - prevLogLik) < 0.1 && emIteration > 0;
				document.getElementById("converged").textContent = converged
					? "Yes √¢≈ì‚Äú"
					: "No";
				document.getElementById("converged").style.color = converged
					? "#10b981"
					: "#ef4444";
				prevLogLik = logLik;
			}

			// Event listeners
			["mu1Slider", "mu2Slider", "pi1Slider"].forEach((id) => {
				document.getElementById(id).addEventListener("input", drawGMM);
			});

			document.getElementById("kSlider").addEventListener("input", () => {
				document.getElementById("kVal").textContent =
					document.getElementById("kSlider").value;
				generateEMData();
				initEMParams();
				drawEM();
			});

			document.getElementById("stepBtn").addEventListener("click", () => {
				const r = emStep();
				drawEM(r);
			});

			document.getElementById("resetBtn").addEventListener("click", () => {
				generateEMData();
				initEMParams();
				drawEM();
			});

			// Initialize
			window.addEventListener("load", () => {
				drawGMM();
				generateEMData();
				initEMParams();
				drawEM();
			});

			window.addEventListener("resize", () => {
				drawGMM();
				drawEM();
			});
		</script>
	</body>
</html>
